{% extends "base.html" %}

{% block title %}Tạo tác vụ mới - Hunonic Calendar Tools{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h4 class="mb-0">
                    <i class="fas fa-plus me-2"></i>
                    Tạo tác vụ mới - Hunonic Calendar Tools
                </h4>
            </div>
            <div class="card-body">
                <form method="POST" action="/create_simple_task" class="needs-validation" novalidate>
                    <!-- Thông tin cơ bản -->
                    <div class="mb-4">
                        <h5 class="text-primary mb-3">
                            <i class="fas fa-info-circle me-2"></i>Thông tin cơ bản
                        </h5>
                        
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label for="title" class="form-label">
                                    Tên tác vụ <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="title" name="title" required
                                       placeholder="Nhập tên tác vụ...">
                                <div class="form-text">Tên ngắn gọn, dễ hiểu cho tác vụ</div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label for="description" class="form-label">Mô tả tác vụ</label>
                                <textarea class="form-control" id="description" name="description" rows="3"
                                          placeholder="Mô tả chi tiết về tác vụ..."></textarea>
                                <div class="form-text">Mô tả chi tiết, yêu cầu, ghi chú...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Thời gian -->
                    <div class="mb-4">
                        <h5 class="text-primary mb-3">
                            <i class="fas fa-clock me-2"></i>Thời gian
                        </h5>
                        
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="start_date" class="form-label">
                                    Ngày bắt đầu <span class="text-danger">*</span>
                                </label>
                                <input type="datetime-local" class="form-control" id="start_date" name="start_date" required>
                                <div class="form-text">Thời gian bắt đầu tác vụ</div>
                            </div>

                            <div class="col-md-4 mb-3">
                                <label for="end_date" class="form-label">
                                    Ngày kết thúc <span class="text-danger">*</span>
                                </label>
                                <input type="datetime-local" class="form-control" id="end_date" name="end_date" required>
                                <div class="form-text">Thời gian kết thúc dự kiến</div>
                            </div>

                            <div class="col-md-4 mb-3">
                                <label for="deadline" class="form-label">
                                    Deadline <span class="text-danger">*</span>
                                </label>
                                <input type="datetime-local" class="form-control" id="deadline" name="deadline" required>
                                <div class="form-text">Hạn chót hoàn thành</div>
                            </div>
                        </div>
                    </div>

                    <!-- Thông báo -->
                    <div class="mb-4">
                        <h5 class="text-primary mb-3">
                            <i class="fas fa-bell me-2"></i>Thông báo
                        </h5>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="notification_time" class="form-label">Thời gian thông báo</label>
                                <input type="datetime-local" class="form-control" id="notification_time" name="notification_time">
                                <div class="form-text">Thời gian gửi thông báo nhắc nhở</div>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="category" class="form-label">Loại tác vụ</label>
                                <select class="form-select" id="category" name="category">
                                    <option value="general">Chung</option>
                                    <option value="work">Công việc</option>
                                    <option value="personal">Cá nhân</option>
                                    <option value="meeting">Họp</option>
                                    <option value="deadline">Deadline</option>
                                    <option value="other">Khác</option>
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="priority" class="form-label">Mức độ ưu tiên</label>
                                <select class="form-select" id="priority" name="priority">
                                    <option value="low">Thấp</option>
                                    <option value="medium" selected>Trung bình</option>
                                    <option value="high">Cao</option>
                                    <option value="urgent">Khẩn cấp</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Nút submit -->
                    <div class="text-center">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-save me-2"></i>Tạo tác vụ
                        </button>
                        <a href="{{ url_for('index') }}" class="btn btn-secondary btn-lg ms-2">
                            <i class="fas fa-arrow-left me-2"></i>Quay lại
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // Auto-fill end_date when start_date changes
    document.getElementById('start_date').addEventListener('change', function() {
        const startDate = new Date(this.value);
        const endDate = new Date(startDate.getTime() + 8 * 60 * 60 * 1000); // +8 hours
        document.getElementById('end_date').value = endDate.toISOString().slice(0, 16);
    });

    // Auto-fill deadline when end_date changes
    document.getElementById('end_date').addEventListener('change', function() {
        const endDate = new Date(this.value);
        const deadline = new Date(endDate.getTime() - 1 * 60 * 60 * 1000); // -1 hour
        document.getElementById('deadline').value = deadline.toISOString().slice(0, 16);
    });

    // Auto-fill notification_time when deadline changes
    document.getElementById('deadline').addEventListener('change', function() {
        const deadline = new Date(this.value);
        const notification = new Date(deadline.getTime() - 1 * 60 * 60 * 1000); // -1 hour
        document.getElementById('notification_time').value = notification.toISOString().slice(0, 16);
    });
</script>
{% endblock %}